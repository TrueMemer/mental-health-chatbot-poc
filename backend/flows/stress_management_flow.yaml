id: stress_management_flow
trigger_keywords:
  - stressed
  - overwhelmed
  - pressure
steps:
  - id: start
    engine: basic
    bot: "I'm sorry to hear that you're feeling stressed. Would you like to talk about what's causing it?"
    user_response_required: true
    set_context:
      isInFlow: true
    branches:
      - condition:
          engine: basic
          expected_user_keywords:
            - yes
            - sure
            - okay
        next_step_id: explore_stress
      - condition:
          default: true
        next_step_id: offer_help

  - id: explore_stress
    engine: ai
    ai_prompt: "Encourage the user to describe their stressors in a supportive manner."
    user_response_required: true
    ai_classification:
      engine: ai
      ai_prompt: "Identify the main category of stress from the user's response: 'work', 'personal', or 'other'. Only respond with the category."
    branches:
      - condition:
          engine: ai
          expected_classifications:
            - work
        set_context:
          stressCategory: work
        next_step_id: work_stress
      - condition:
          engine: ai
          expected_classifications:
            - personal
        set_context:
          stressCategory: personal
        next_step_id: personal_stress
      - condition:
          engine: ai
          expected_classifications:
            - other
        set_context:
          stressCategory: other
        next_step_id: general_stress
      - condition:
          default: true
        next_step_id: offer_help

  - id: work_stress
    engine: basic
    bot: "Work-related stress can be challenging. Have you considered any strategies to manage your workload or talk to a supervisor?"
    user_response_required: true
    branches:
      - condition:
          engine: basic
          expected_user_keywords:
            - yes
            - I have
        set_context:
          hasWorkStrategies: true
        next_step_id: work_strategies
      - condition:
          default: true
        set_context:
          hasWorkStrategies: false
        next_step_id: suggest_work_strategies

  - id: suggest_work_strategies
    engine: ai
    ai_prompt: "Provide practical advice for managing work-related stress, such as time management or communication tips."
    user_response_required: false

  - id: work_strategies
    engine: basic
    bot: "That's great to hear. Remember, setting boundaries and prioritizing tasks can be helpful."
    user_response_required: false

  - id: personal_stress
    engine: basic
    bot: "Personal stress can take a toll. Would you like to discuss coping mechanisms or resources that might help?"
    user_response_required: true
    branches:
      - condition:
          engine: basic
          expected_user_keywords:
            - yes
            - please
        set_context:
          wantsCopingMechanisms: true
        next_step_id: personal_strategies
      - condition:
          default: true
        set_context:
          wantsCopingMechanisms: false
        next_step_id: offer_help

  - id: personal_strategies
    engine: ai
    ai_prompt: "Suggest healthy coping mechanisms for personal stress, like talking to loved ones or engaging in hobbies."
    user_response_required: false

  - id: general_stress
    engine: basic
    bot: "Stress can come from many sources. Sometimes, simple relaxation techniques can make a difference. Would you like some suggestions?"
    user_response_required: true
    branches:
      - condition:
          engine: basic
          expected_user_keywords:
            - yes
            - sure
        set_context:
          wantsRelaxationTips: true
        next_step_id: relaxation_tips
      - condition:
          default: true
        set_context:
          wantsRelaxationTips: false
        next_step_id: offer_help

  - id: relaxation_tips
    engine: basic
    bot: "Deep breathing exercises, taking short walks, or practicing mindfulness can reduce stress levels."
    user_response_required: false

  - id: offer_help
    engine: basic
    bot: "I'm here if you change your mind or need someone to talk to."
    user_response_required: false
