id: anxiety_coping_flow
trigger_keywords:
  - anxious
  - anxiety
  - nervous
steps:
  - id: start
    engine: basic
    bot: "I'm sorry to hear you're feeling anxious. Would you like to try a calming exercise?"
    user_response_required: true
    branches:
      - condition:
          engine: basic
          expected_user_keywords:
            - yes
            - please
        next_step_id: breathing_exercise
      - condition:
          default: true
        next_step_id: discuss_anxiety

  - id: breathing_exercise
    engine: basic
    bot: "Let's try a simple breathing exercise. Inhale slowly for 4 seconds, hold for 4 seconds, and exhale for 4 seconds. Repeat this a few times."
    user_response_required: false
    next_step_id: check_in

  - id: discuss_anxiety
    engine: ai
    ai_prompt: "Encourage the user to share more about what's making them anxious in a supportive manner."
    user_response_required: true
    next_step_id: provide_coping_strategies

  - id: check_in
    engine: basic
    bot: "How are you feeling now?"
    user_response_required: true
    ai_classification:
      engine: ai
      ai_prompt: "Determine if the user's anxiety has 'reduced', 'remained the same', or 'increased'. Only respond with the classification."
    branches:
      - condition:
          engine: ai
          expected_classifications:
            - reduced
        next_step_id: positive_feedback
      - condition:
          engine: ai
          expected_classifications:
            - remained the same
            - increased
        next_step_id: provide_coping_strategies
      - condition:
          default: true
        next_step_id: offer_support

  - id: positive_feedback
    engine: basic
    bot: "I'm glad to hear that helped. Remember, you can use this exercise anytime you feel anxious."
    user_response_required: false

  - id: provide_coping_strategies
    engine: ai
    ai_prompt: "Suggest coping strategies for anxiety, such as mindfulness, journaling, or talking to someone they trust."
    user_response_required: false

  - id: offer_support
    engine: basic
    bot: "If you'd like to talk more or need additional support, I'm here to listen."
    user_response_required: false
